<%- include('partials/header'); %>

<div class="background-top"></div>
<div class="background-bottom"></div>

<div class="container">
    <h1 class="text-center my-4">SB 1383 Compliance Calculator</h1>
    
    <!-- Tab navigation -->
    <ul class="nav nav-tabs mb-4" id="formTabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="step1-tab" data-bs-toggle="tab" href="#step1" role="tab" aria-controls="step1" aria-selected="true">Step 1: Enter Data</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="step2-tab" data-bs-toggle="tab" href="#step2" role="tab" aria-controls="step2" aria-selected="false">Step 2: View Results</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="step3-tab" data-bs-toggle="tab" href="#step3" role="tab" aria-controls="step3" aria-selected="false">Step 3: Next Steps</a>
        </li>
    </ul>

    <div class="tab-content active input-container" id="formContent">
        <!-- Step 1: Enter Data -->
        <div class="tab-pane fade show active" id="step1" role="tabpanel" aria-labelledby="step1-tab">
            <h1>Jurisdiction Information</h1>
            <div class="d-flex justify-content-center">
                <form id="step1Form" method="POST" action="/step1" style="width: 60%;"> 
                    <div class="mb-3">
                        <label for="city" class="form-label">City/County Name</label>
                        <input type="text" class="form-control" id="city" name="city" value="<%= city || '' %>" required>
                    </div>
                    <div class="mb-3">
                        <label for="population" class="form-label">Population</label>
                        <input type="number" class="form-control" id="population" name="population" value="<%= population || '' %>" required>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="btn btn-secondary next-step" id="nextBtn" disabled>Next > </button>
                    </div>
                </form>  
                 
            </div>
        </div>
        
        

        <!-- Step 2: View Results -->
<div class="tab-pane fade" id="step2" role="tabpanel" aria-labelledby="step2-tab">
    <h5 class="text-center">City: <%= city %></h5>
    <h5 class="text-center">Population: <%= population ? population.toLocaleString() : '' %></h5>

    <h4>Procurement Requirements</h4>
    <div id="resultsContent">
        <!-- Card for the first table -->
        <div class="card table-container">
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th class="column-1">Requirement</th>
                        <th class="column-2">2024</th>
                        <th class="column-3">2025</th>
                    </tr>
                </thead>
                <tbody>
    
                    <tr>
                        <td>
                            SB 1383 ROWP Procurement Requirement
                            <br>
                            <small class="text-muted ms-3 fst-italic">Note: SB1383 requires .08 tons per person</small>
                        </td>
                        <td><%= requirement2024 ? requirement2024.toLocaleString() : 'N/A' %> tons</td>
                        <td><%= requirement2025 ? requirement2025.toLocaleString() : 'N/A' %> tons</td>
                    </tr>                    
                </tbody>
            </table>
        </div>

        <h4 class="pt-4">Calculations Based on Constants</h4>

        <div class="card table-container">
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th class="column-1">Resource</th>
                        <th class="column-2">2024 (Tons/Units)</th>
                        <th class="column-3">2025 (Tons/Units)</th>
                    </tr>
                </thead>
                <tbody>
                    <% const safeResults2024 = (typeof results2024 !== 'undefined' && results2024) ? results2024 : {}; %>
                    <% const safeResults2025 = (typeof results2025 !== 'undefined' && results2025) ? results2025 : {}; %>

                    <tr>
                        <td>Electricity PCA</td>
                        <td><%= safeResults2024.electricityPCA ? safeResults2024.electricityPCA.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.electricityPCA ? safeResults2025.electricityPCA.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Renewable Gas Fuel</td>
                        <td><%= safeResults2024.renewableGasFuel ? safeResults2024.renewableGasFuel.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.renewableGasFuel ? safeResults2025.renewableGasFuel.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Electricity from Renewable Gas</td>
                        <td><%= safeResults2024.electricityRenewableGas ? safeResults2024.electricityRenewableGas.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.electricityRenewableGas ? safeResults2025.electricityRenewableGas.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Heat from Renewable Gas</td>
                        <td><%= safeResults2024.heatRenewableGas ? safeResults2024.heatRenewableGas.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.heatRenewableGas ? safeResults2025.heatRenewableGas.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Compost (Tons)</td>
                        <td><%= safeResults2024.compostTons ? safeResults2024.compostTons.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.compostTons ? safeResults2025.compostTons.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Compost (Cubic Yards)</td>
                        <td><%= safeResults2024.compostCubicYards ? safeResults2024.compostCubicYards.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.compostCubicYards ? safeResults2025.compostCubicYards.toLocaleString() : 'N/A' %></td>
                    </tr>
                    <tr>
                        <td>Mulch</td>
                        <td><%= safeResults2024.mulch ? safeResults2024.mulch.toLocaleString() : 'N/A' %></td>
                        <td><%= safeResults2025.mulch ? safeResults2025.mulch.toLocaleString() : 'N/A' %></td>
                    </tr>


                    
                </tbody>
            </table>
        </div>

        <!-- Button row between the tables -->
        <div class="button-row text-center">
            <a href="/" class="btn btn-secondary"> < Back</a>
            <button id="savePdfBtn" class="btn btn-success">Save as PDF</button>
            <a href="/find-out-more" class="btn btn-primary">Find Out More</a>
        </div>
    </div>
</div>


        <!-- Step 3: Placeholder for Next Steps -->
        <div class="tab-pane fade" id="step3" role="tabpanel" aria-labelledby="step3-tab">
            <h3>Next Steps</h3>
            <p>Additional information or actions that users can take after completing the calculator.</p>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>


<script src="/js/scripts.js"></script>

</body>
</html>
